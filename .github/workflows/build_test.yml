name: build test

on:
    workflow_call:
  
jobs:
    build:
      name: build test
      runs-on: ubuntu-latest
      steps:
      - name: checkout repository
        uses: actions/checkout@v3
      - name: Uses checkout submodules
        uses: MertensFlo/StateOS_BA/action_checkout_submodules@vTesting_workflows
      - name: install dependencies
        run: |
          sudo apt-get -y -qq update
          sudo apt-get -y -qq install cmake ninja-build
      - name: install arm-none-eabi-gcc
        run: |
          wget -q https://developer.arm.com/-/media/Files/downloads/gnu/11.3.rel1/binrel/arm-gnu-toolchain-11.3.rel1-x86_64-arm-none-eabi.tar.xz
          tar -xf arm-gnu-toolchain-11.3.rel1-x86_64-arm-none-eabi.tar.xz
          echo "${{github.workspace}}/arm-gnu-toolchain-11.3.rel1-x86_64-arm-none-eabi/bin" >> $GITHUB_PATH
      - name: check arm-none-eabi-gcc version
        run: arm-none-eabi-gcc -v
      - name: make test
        run: |
          cmake -S. -Bbuild -GNinja
          cmake --build build -v